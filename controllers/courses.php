<?php	session_start();		include "models/viewModel.php";	include "models/protector.php";	include "helpers/db.php";	include "models/coursesModel.php";		$courses = new coursesModel();		$view = new viewModel();		$regs = array(					"courseName" => "/^[a-zA-Z]+(([\'\,\.\- ][a-zA-Z ])?[a-zA-Z]*)*$/",				  "startDate" => "/^[0-9]{1,2}\/[0-9]{1,2}\/[0-9]{4}$/",				  "endDate" => "/^[0-9]{1,2}\/[0-9]{1,2}\/[0-9]{4}$/"				  );	// formValidation	function formValidation($post, $regxs){		foreach ( $post as $field => $value ){			foreach ( $regxs AS $f => $v ){				if ( $field == $f ){					if ( preg_match($v, $value) ){						//$status[$field] = true;						//echo "TRUE";					} else{						//echo "FALSE";						//$status[$field] = false;					}				}			}		}	}								// Header View	$view -> getView("views/header.php");			if ( !empty($_GET["action"]) ){		if($_GET["action"] == ""){			// Get any courses that are already in the database			$data = $courses->getCourses($_SESSION["user_id"]);						$view->getView("views/courses.php", $data);		}else if($_GET["action"] == "addnew"){			$view->getView("views/addnew.php");		}else if($_GET["action"] == "newaction"){						formValidation($_POST, $regs);			// Save user inputs			$c_name = $_POST["courseName"];			$start_date = date("Y\-m\-d", strtotime($_POST["startDate"]));			$end_date = date("Y\-m\-d", strtotime($_POST["endDate"]));			$user_id = $_SESSION["user_id"];						$assignments = array_slice($_POST, 3);			$array_chucked = array_chunk($assignments,2);			$newCourse = $courses->addCourse($user_id, $c_name, $start_date, $end_date, $array_chucked);						// After we add the new course to the database, reload all the courses			$data = $courses->getCourses($_SESSION["user_id"]);			$view->getView("views/courses.php", $data);		}else if($_GET["action"] == "delete"){			$course_id = $_GET["cid"];						$courses->deleteCourse($course_id);			$courses->deleteAssignments($course_id);			$courses->deleteStudents($course_id);			$courses->deleteGrades($course_id);						// After we delete a course from the database, reload all the courses			$data = $courses->getCourses($_SESSION["user_id"]);			$view->getView("views/courses.php", $data);		}else if($_GET["action"] == "edit"){			$course_id = $_GET["cid"];						$course = $courses->getCourse($course_id);			$assignments = $courses->getAssignments($course_id);						$view->getView("views/editcourse.php", $course, $assignments);		}else if($_GET["action"] == "editaction"){						$cid = $_GET["cid"];			$c_name = $_POST["courseName"];			$start_date = date("Y\-m\-d", strtotime($_POST["startDate"]));			$end_date = date("Y\-m\-d", strtotime($_POST["endDate"]));									$assignments = array_slice($_POST, 3);			$array_chucked = array_chunk($assignments, 2);						$courses->editCourse($_SESSION["user_id"], $cid, $c_name, $start_date, $end_date, $array_chucked);									// After we edit a course from the database, reload all the courses			$data = $courses->getCourses($_SESSION["user_id"]);			$view->getView("views/courses.php", $data);		}	} else {		// Get any courses that are already in the database		$data = $courses->getCourses($_SESSION["user_id"]);				$view->getView("views/courses.php", $data);			}			// Footer	$view->getView("views/footer.php");	?>